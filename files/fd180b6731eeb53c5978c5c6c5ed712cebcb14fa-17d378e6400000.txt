# https://syzkaller.appspot.com/bug?id=fd180b6731eeb53c5978c5c6c5ed712cebcb14fa
# See https://goo.gl/kgGztJ for information about syzkaller reproducers.
#{"threaded":true,"collide":true,"repeat":true,"procs":6,"sandbox":"none","fault_call":-1,"tun":true,"tmpdir":true,"cgroups":true,"netdev":true,"resetnet":true,"segv":true}
bpf$MAP_CREATE(0x0, &(0x7f0000000400)={0xe, 0x4, 0x4, 0x8}, 0x2c)
perf_event_open(&(0x7f0000000180)={0x2, 0x70, 0x3e5, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x9, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x2, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, @perf_bp, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1}, 0x0, 0x0, 0xffffffffffffffff, 0x0)
bpf$MAP_CREATE(0x0, &(0x7f0000000000)={0xffffffffffeffffd, 0x0, 0x0, 0x0, 0x0, 0x1}, 0xffffffffffffff81)
r0 = perf_event_open(&(0x7f0000000180)={0x0, 0x70, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, @perf_config_ext}, 0x0, 0xffffffffffffffff, 0xffffffffffffffff, 0x0)
recvmsg$kcm(0xffffffffffffffff, &(0x7f0000000080)={&(0x7f000000d700)=@ll={0x11, 0x0, 0x0, 0x1, 0x0, 0x6, @broadcast}, 0xe7, &(0x7f000000d940)}, 0x0)
r1 = perf_event_open(&(0x7f000025c000)={0x2, 0x70, 0x3e2, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, @perf_config_ext}, 0x0, 0x0, 0xffffffffffffffff, 0x0)
close(r1)
r2 = socket$kcm(0x2, 0x3, 0x2)
r3 = openat$cgroup_ro(0xffffffffffffff9c, &(0x7f0000000380)='cpu.stat\x00', 0x0, 0x0)
openat$cgroup_subtree(r3, &(0x7f00000003c0)='cgroup.subtree_control\x00', 0x2, 0x0)
ioctl$PERF_EVENT_IOC_SET_FILTER(r1, 0x8914, &(0x7f0000000780)="6e7230010060a19ef9d2c673d9a1571cb9e1369bcd61ef7e49793ae18712eceb1daa769497800b7fbbd35b170c10751d39aeb660d863e49b8c4f3b3dad48902b5b2d6cfd0abd372c63bcf5d70df3fd4d2e8d443c88bc0e5637dd82fc3435bed4de5d693c9a781c863e05d8a6f8689a5be29216061f3ff53f8b6b396678e7ba155ef9152d7e43b1eccb2331eb8eb1ed5586dcf8b3b0b999361a44ff2c22c2abbef42dd24eabe6723346a6e46c0499a21442d8d00dcb57f013ff7595edd0ff076930de3675d34117a44eb0e4f832936da44e57e43a3e36bd48d2a85bf4fd4a804e83f2f3cf378a435af5e287d4e27337b4ada11b26219832ec6b2b38446b3b95fe3771e9f42ca30fb21e12f0a3d8bc2d85454af9fcc0232d8fd909448b01f46c593d31ea1c926465e35a4199079c3ca41128b17cb01fbf5b522be0fd02022ada37fecc14b6c8c8831883b85a1106f2f867020d529f17a350f20dd3bf51a98cfda70c2e3638a483fd3f87940bb478b07c4c110394c0093d17955089f2ca97bbe075124c9b1ff6500d536a95d96f03d48596e008bf0a028b539cec796cec9bf585eb80fe3e0d26")
ioctl$PERF_EVENT_IOC_PAUSE_OUTPUT(r0, 0x40042409, 0x0)
r4 = openat$tun(0xffffffffffffff9c, &(0x7f0000001a00)='/dev/net/tun\x00', 0x2, 0x0)
ioctl$TUNSETIFF(r4, 0x400454ca, &(0x7f0000000300)={"6e72300100", 0x1132})
sendmsg$kcm(r2, &(0x7f00000002c0)={&(0x7f00000000c0)=@sco={0x1f, {0x8, 0x2, 0xe2, 0x17, 0x79, 0x10000}}, 0x80, &(0x7f0000000040)=[{&(0x7f0000000440)="dde204b4a13fa5968dde009be54f91871a77630248fcc1658fb5ea272912c8654f6ad39ce2064f7e15128c3941253416a1854316651d302ee0bf798555c853ed3bed00fc0dcf148f86184f2e91b573fe6af2d2747d4c217f9625af1229347b5134a5538729cad61b3187f1de76aa2a0f6e77a50080dab5349e8e2d7e4ed352dce1c3f2b16d6ea5bd0ba95c1fda6eded9f1affa2bee4ecf356f92413d70d24fb85c43c4f7c88846c37d6fed8f9be99692f21012ea13d98302cf91e60c8910e90ddd6aa8410ea371f8bc1004860c69c269834558fb2bb67fc2659807fc9e1bc629ff8734b537ae", 0xe6}, {&(0x7f0000000200)="f66adae09cf832716b5ab7b0f0f82db597cfdef9339792493f8f6617fcf85ddc2a3dfdeb766efb372e205b8f4c9db3f22307e51f15058189cd8f8239fc9652ae577b9af56c634b80c87ceb2011852b69cdeb50e6b5c417e3260b73fc87d34d", 0x5f}, {&(0x7f0000000540)="312fffc05c185415be14abb810e2e1b49df944237ba85ad0185eaff1bb5b230a06cae551e5c75069a6070f0b05db717f593e4e539123ac13b5086b4db3fe08bd09b75a3577085882b9684ef6c69bc26b9165c5b4675c4e4759a664d2caf03e305944b84603c689301ce54d612397b77aae3bd90c2691ebc025e404270ad67a7beecab60c13a3b424afbbf89e860630b5babe44328cf0", 0x96}], 0x3, &(0x7f0000003040)=ANY=[@ANYBLOB="10100000000000009d010000010000004af8dec32e86f9e59249c9263f4c70f67c2a1e9fafee3d1a0f2dead0179b8859e9a1f15556aee176250c49d0291c61e40b393ab3dacc5a12fd547e43a121384a522c5fae8b272e8a874b646d7f5f7d48eab9aac54855f32d1482a658a9f695091aa8331b164439acac13a53253e69e3e1d09b6fdb94146efe27c99ed8bcc3df30b5d18141f148070454b3418934aa04f9bec4bad568d211867abc07e7264f51766c378d2389a2e73788e13d20a487164095490887dde7cdeebf1fc47d9c31e592fc2c4a6c8e369f0a050598ebf097aa8191059e6bc6893aa8895f05865e87a9d37eb40ff9939c59904f9cac21c92edd79665921e61b6a930635090289c1d243ceb8e1190ade9b261ce4b5961c62957078342c1660af10468d322e5b2bcd23e8109673ef822b1bdce011bb6fbb92478f3022bb095c74e6bf27aab19b393929fa73d0765f0339c32f219faf29909cb21c07f07640e6c668725f4622b0066b2d0e9a3a16a9abe750b8afdf37bd9ef3c3fd59880bf3013732063e9a9ff1ba04e1dcc5f7898039b6d3469f7c89caff20c550b838d9615aa72c2d8ebe040a07cdeca69cb870d5d3281f6ee03b891764389481c22d9bf00a585b00c0aa9be13926660c679c7683b418ec15e9289ea416a556c792a47217497833e8dfba61b3ee0a5d1cb11c01769f1c2440429e2d33facf70c27b0ecf3ac4d4d38ce570db024f7949b455950cee11427516c9bf5b655dc047a72834435766377daf191288f11a7c9efe0379f280ec82d89bbe3815dbfbfe3632a412e4b42202d88384af0e66c07cdc82c18b2e6a9334e559ba7346a5de5208202ca7fe51a33022a40dba8716394cd8a6cb85dcb9294664b196ebe886b4cd7a94d14c2401989fb8f1ab7e8c49375789528768ad615def4e94570337a2838023329069a2c73d0f57f32bd760b3dd12a57a737e23c223dd9fc4a23504ebffff927b523764c55b225af0b70aa103b6cd89362c456f5d644de325c20afdc11fa30a57ecf30c5227d877da4da2c76760da84977d6435c408818f484d82fbfae8981f46cb85d6d6ef612daabb0ea6045a4a20e72eb29be2c467cc0b05d6bdfba6c69f8a49ae9d94cbf91063c5d973d8f19fb5daa3548eafd59cc687a42ebb74f1b227209f19186e4775bd81251d4dac3a839809b15822ee47ce6c68c3114b203fff5a45f92aad0475fdd7eb9eb375d077b095d6e90dc0f9203e664f98b3509388debd40eae79c3d58499ce1f3c5471453d8b58b2b452bb63cb46c990366ee37db8ed6b9853271f9d634ae663f089e70ebad8a970306b8a5f0f03e8992cb00f1509f2ead6af9cf0a988c4fef1ac4f50b471d0e3ca568d110acabdb0adffec840077acae2ce28386084964421c061fcb7c6018fd04f76734608fb1f1756c76dc688262b4cc056d5807b34bf0e06418d03b8c53eac0f3c6ba9ff0ed01de644160a3cfecbe314cab2964b2f688cb5a1b7e7220cd2f726c03251ada80ef99c648d9a7e4857487f156bc8281985963205d2997f4ecee84c909fb77a7bb5b02f4241387bab4613087092e7c31b4b51e9ae238a9979a3bfeaf618be56fb04919aea28c3a0bf67ce0b2c5527209ded7f6211b46b1017ccc0caed7888b020d54b2a19a133028a1b59ae1ff94db90547f14801cdbeb4b801a834b3ad052ecb9e58e985ae7cc2e3dda74f01585be623943c4419e14a4e2935ea3347a2e850fd4de6caf35ba9d8b1a1df78c97a79a065ad86895c37ff9780dd524b6b89865fd33aab3508147047f9441039e23da05560ee3aeeb78b4ad93da0aecae428f95e0af951430b2d8d035b4090e36401b6dc59ff97188757ccd7c624e838741816d43e453a97b362d78a3c64bfea33125a3a25825cac63cbee6502dfd4bca4e97459a751c3293df0bb218e859a7e13677f28a816710ec556ab729c9264c59463575f8f26412897a9ca513903fd5e888ad4a7675eda7b1eb31a63668a0b1299dc3ab3f72581ae1d96a62d47485bd9e34bb00e7da20a5867c5dbb6aa93ccb1c10e411c257e0b0283320dae1efe0ad2d1b822f306a72d1c6f66163d58bac6b50ffa789a5c633cff94bd6a190b7a20d1cf74fb21edef31ac1217bf829e4cdd14947fa72e1d0eb0ed6794137e6e4a5294cd656fcafe4979a3d378f02dc2805726e2982ea083fa7105efb8dbd9f7eb1ba889eeb1759dea14263816749a0187e5f9b474be62b764cf85d0d75f47a2a8e31060e4acad286005ac846b38e90a0ca4366d892b55493cd9141a2a5414805fa02b822554a908a55814b631b980603a94d6d9cd667df8b60cb524cf939a3e8fb73f783aae76b81bebf2e08edbd724202abd90ea388cb660fb3ef8a93162babf09208e51f444499d579770b715e4fc3f84ec699ac63bb47dc15ca99031870cbdac4d54b8c16c577767b9261ddb7751cee8f0eb901f1e07984207352306d59526c5e31a272b1677dbc55eb40fdd81d5cc451e4a58352c0739095b4d451a49adf7eaed1de238bc660e46c2bb1658cb80168f0641c2942b595722ff52503be40b79cf587f4e8e4244b03e9ae729f7051fe21e534b724faec374b50781e1ef264be100bf642e1514103dee2bbdd06ee014f4f45ea9f7347fe7c3950db104b3222d2a3696641dde9c33842b909f64f391c53f1a84447b836fa269f85342333504c0f12df8e89099b07d8fde841cf19759cf26b83b478f1eeccbf2a39f55b809083be41a6ddffb146e0f030d5f0ae71e44428f6bae09f2bbaba60cb685983be8947a96bda853e8b37e42358c96a34512de29617330b0ac085092a8afff62f06f047b4f2d618bb047867cd20360ca5f966d5fa0395fcf54eb223c0979e2e55a2d14ca3196386a0a56b2de11916111290bb4dd6aa9bbeb6efe5e3a7100c9f4c8c467c98ae960ce64b59ad286638255788d949ec23edf52f7d8dab571bfd3485142f28f40b3edd846a42d8e0520c72f31748d731905a53f1b5c2212c12b55cfc14edd3a6799b1b409c232b951776886b12285b28441293e92ce5286b49a1b497b3efb7cd0d7a47305f11149b6902079b6dd469cb6fad26d96f351154d15af6b7c394a02b237291fe43c474cd19f380a8ea11304e02a87e70b405daae82727795f0b9e93e2baedd36eabb450fe217cb741bc48df0f6d8775ba56bc244efaa15636ef416dd0a0fb7b6f22c06c7e9b807e3ec79334a60cbe5bb43cfde768110c09fbc2412c68c0c7b1c39924bf9390ea99fb4f29545f2e0fd330360b20af6e3b0142a0087279b80e64bccb55d5923a36e7c0401626a27bc4f0dd72bd23149da8b56c4e22bb64b559067e1e50a68ac063d325d318bed45efe361d72bb6697506e1c398b12755e06139767c7c2306993e66c289ccef3b97ddb8448352b89dc40c9c8b2952e0f81ecc067bce50312c55f814530705edd9b342316b2b4b4960ece121268ed1927ad666f0082bb138f0378c37fca5c4e3f0700d1205464240ad1df503cbdb0de4d4b868e95b59783e1c678b68c6cf0c0ddbe670f6966ce5e2e495163affc468d49fd0846281f6ad44c02d30792fd90be78160be88a9a4beeb3100df148873703874f03ecb960224c00f4b71be3184004d08816daca6d6f3f3176192916829fb9b0020771e896ae7840ad3611801420c979f5ba68aa6d0d5e0e75819d3756d4bb65541407853863ef9f367558084bd9add2f4b474ade1a05a5a106db5be003aad5a550cb8f88cc040ccf7f8619727fe688d2f19f17295c5f243413388bf20805659dd1a4c3039e317a1fd6ea642465733f03e513fc840879a84c2a897d288330f9f91790c79bae042c9c6c5ed5386e650322d42a57a6cb4ddd4ba593894cea786b5d8c8c4eae2871d75824a66016f3373529e64b51154082e487bd1c231cb686d91a552ea155a781814be79cb2a7d32e33444df65ed2b60801151b23e73dc37a370af4f2bdcc6d188b05248188fe9aa4bf3a1c6eae7f9cdcd24381c207aeeb6d3f79b75ea496621b03d52e2d06ad2db7ec92d998d2c4f42d2c73b5e9c587f658e9a1ae135c7dd2d79dc9a060fcc0efa096162026fbbb2364b57b0328f53ca9cf606a3bc763847165fedfb0b07a10d399f0c8864efe93e97f0f03b3309b4373060e2352d7eae4debab847d781b58ff46b708c5a20b29b2f7162c3f96141280790298a58757bdd6913e1555267bcdb5a0f1d3ee9fbf29ec6646da1a34e226eea96bbe3830da1d323ee53778a0b561219d9b4033a44d1d200e00f9c65c0318a69d32f53f5ecc6206671ae397fd2702a21a4608d5d8699cca1f1e16d2d08c2407965a80aaa3eff8a83eff838a252208d01a76aa81806f7030eaec6a9fa284c630b7e7877a306ca07f8daf83acfea89d7baf94826e9adf4117c45ff99ec682dcb150156bc163b19c97239ed5aa42e199e92ddda4a6037bc003cbe089ea8b4e9703028158654ecbcfddfe47400edc25a793df6d8e1d7e76e3a77657d60714218a40b6e99113fa5d7687a6d89e365cb31de500ba56acadd7ebbb9bea21161aaf623daaac0b1ccd27438da2964ca1979e6fec3e5c075d2a35495e30fb4e830ae48c0862fb56e097983bea3d334ed28bcc1a1547268ac829b37fd33472266b015fe5f187e7785a7fd476f037bffe586c9e597fda8d71566f271cf990ebdd9c3fdfaf35a1a9d771e242248d0cd8d4ecc024131a67c877c3401e4cad7613b9dcc2b9f0b066d04f63467b42075e506ea4f5b3e409a40a75fc2f51b0a89dc61b657f2063f5d94149e548a039c92fd90e6369e1000f94946a4b3750dcfd2734e087d8c6cdd18c9e7ce3c1e032919c8c32d1f31b28315ef6232f5036c58dab227f5c3f57145e77d6f8f407c7ed1557b3aab8e78ef455bf80072a9126acc96a7e13fcc2a5327373aac537d265b5192578842725e6be5c471c1e1d8c88e979d8fa468f30eb68fce234ffb3c3627c5fae1ee6598abbe1c5976f73bbc080c6d3eb2d7e71dc3ff34a76296bb846d8015b8eb8ffae865a4f3ca880bd1a65a9977e0663ff947c7f2ed272633308ae2cfdae27b6310407fd854037859867210c2e8ac3d6f309cee712bc7625f0b8ad5d507b92bd8c5a9233eb8e4ba703f3a0639b50084816bab81e5a714ca949d4c8915827c3815e188c71d28e3d7227124ee57a48e746bbeeff9df8966a254f0e2b2ff90becaacf05b9e1a6d84837100d5342212d7df72be556c94bd018e670638bf0a6433d3edf6e04dcc2b3f30a3593d358dfa1654152714bb430547b2b417aec2dcdc058301866ee5c9e50411840d8b3927970f9af531f75bce9b0dd9f816ce95c66e7c118f922a4d87f386a60526e2ab709f2a784260a7b14fca8af38737e0937087f6c8953cb34ea2503f4ccc6099022839d45afdf1a5df897f9e8b3ad8a31a9273a1453058732dc6b5d2e89b05d3df77b2ea976394bf893f5e84b8e663fff6cf65bce12a97ed5d90c59e300fe2a7c1d3084fdb9188dba88257375b40183d82753d30006a08359119e250ebdffb8fbd58af903a11d8de83bb774281354095463627721cc237c1302a8506ee1e89f1c77dd7f2f968791cfaa920da897aa668895497f8ddcac21993ac2ffea9ed2afb54ca9440958944e9e68d2ac053cef8e440d11ff7a73b4bc525bc3d4f8d56678dbb91ae4f548c7f12dac3e2afece0c12b8e63405fd3c71462a9dee48b700ced193aeea020a30753879c936f71f53645a2617cc51a6523d0d897f6abc28b66304a4b60062ebc0762670676d98aeca04a87f453ba915d9d6f4f10c44df0606d13a131d000000000000000040100000200000095d921e3d83bfaa57294d8fcfc3f7ea598d57cf4a26b0b630d1893c9485bed92372834ec935027d78cf4ded67aee7f9b4ce0422ce672d6fa56a370fab2d0277e4108831c6add5f983b2af44a5257b6d7bef09c07a851582fe364e14d5f26325cf2e766f9a95fc6ce3602cabf129c5bb38edb4ac8b5aca23f551c7a497644ff3bc1f993473ab311d646cd5676120c060e71e8e2c4f2e73be5609463652a45a4af22dfa37d391a8c4c5079fc45e71d2c47486521edb6f64ea13b20d2911d00000038000000000000000b01000000000000730e9ae7a053c8d29f144f737a305b921a308c388c1c9d3e5d77a314f32627668a00000000000000c00000000000000017010000ffffff7f8c6355868e94ca1eacd226e8763ba8679f2e4192d8d971ee1d433cde48c683ab99cfead638a3ad8f49308b5cb4d536dc933ed5aed07d97fd3dd184f49585967861abe7f1cf7b5977ff3ad81a1ad00004499c9cd4c86de097dc5129a488ef49541282d28d890adc96155c77d6ff079e20beebc58f783abdb6f7fa23f748a16a32ce1e1294529aba1eb3eae91b62063822df705687827e075de18bacd98ed6f70cc06780df2e5495c77e51f21d23590000643f4ae27562e2c74d22d1e0c755404ae59918eb94abb12e26668a5f1d739977b9dfb6fd5284cd2d7d88256e0d34b44c505339557c525e485aeccbb4df30d084d577ba16af554f0b129c67ccd025bae7efec361d9bf13ea902384332d690759708c0d248e55f75045d8e397223eb27ff71b4350da7113ba33a0cbbf18dfe2096e3c1fbdd1037840dd6c7bd253e1c7aea33f20984611f8b1ec4f09a45"], 0x1274}, 0x80)
perf_event_open(&(0x7f0000000180)={0x1, 0x70, 0x0, 0x0, 0x0, 0x0, 0x0, 0x1ff, 0x0, 0x0, 0x0, 0x6, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, @perf_config_ext}, 0x0, 0xffffffffffffffff, 0xffffffffffffffff, 0x0)
socket$kcm(0x11, 0x0, 0x300)
openat$cgroup_ro(r1, &(0x7f0000000280)='cpu.stat\x00', 0x0, 0x0)
bpf$OBJ_PIN_MAP(0x6, &(0x7f0000000340)={&(0x7f0000000140)='./file0\x00'}, 0x10)
write$cgroup_int(r4, &(0x7f0000000000), 0x12)
