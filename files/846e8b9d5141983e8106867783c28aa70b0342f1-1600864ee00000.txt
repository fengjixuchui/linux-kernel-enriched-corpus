# https://syzkaller.appspot.com/bug?id=846e8b9d5141983e8106867783c28aa70b0342f1
# See https://goo.gl/kgGztJ for information about syzkaller reproducers.
#{"threaded":true,"collide":true,"repeat":true,"procs":6,"sandbox":"none","fault_call":-1,"tun":true,"netdev":true,"resetnet":true,"cgroups":true,"binfmt_misc":true,"close_fds":true,"devlinkpci":true,"tmpdir":true,"segv":true}
r0 = socket$nl_generic(0x10, 0x3, 0x10)
r1 = syz_genetlink_get_family_id$wireguard(&(0x7f0000000480)='wireguard\x00')
sendmsg$WG_CMD_SET_DEVICE(r0, &(0x7f0000001340)={0x0, 0x0, &(0x7f0000001300)={&(0x7f0000001380)={0x894, r1, 0x1, 0x0, 0x0, {}, [@WGDEVICE_A_IFNAME={0x14, 0x2, 'wireguard0\x00'}, @WGDEVICE_A_PEERS={0x86c, 0x8, 0x0, 0x1, [{0x54, 0x0, 0x0, 0x1, [@WGPEER_A_FLAGS={0x8, 0x3, 0x6}, @WGPEER_A_PUBLIC_KEY={0x24, 0x1, @a}, @WGPEER_A_PUBLIC_KEY={0x24}]}, {0x54, 0x0, 0x0, 0x1, [@WGPEER_A_PUBLIC_KEY={0x24}, @WGPEER_A_PRESHARED_KEY={0x24, 0x2, "d28d8c71ab99ee0deed32bcde69b819eda3459c14870637225ccea1996db09d6"}, @WGPEER_A_PROTOCOL_VERSION={0x8}]}, {0xac, 0x0, 0x0, 0x1, [@WGPEER_A_FLAGS={0x8, 0x3, 0x2}, @WGPEER_A_PROTOCOL_VERSION={0x8}, @WGPEER_A_PERSISTENT_KEEPALIVE_INTERVAL={0x6, 0x5, 0x6}, @WGPEER_A_PERSISTENT_KEEPALIVE_INTERVAL={0x6, 0x5, 0x40}, @WGPEER_A_ENDPOINT4={0x14, 0x4, {0x2, 0x4e21, @loopback}}, @WGPEER_A_PUBLIC_KEY={0x24}, @WGPEER_A_PRESHARED_KEY={0x24, 0x2, "603e423d09418fc8bfa20e5558d269402e31d26098dd2fa775cb7073b11e598c"}, @WGPEER_A_FLAGS={0x8, 0x3, 0x6}, @WGPEER_A_PRESHARED_KEY={0x24, 0x2, "c34fd29970cc836f3b7b479d311774ca633d3edccfdc3cb6071a0f82e3bc07c3"}]}, {0x18, 0x0, 0x0, 0x1, [@WGPEER_A_ENDPOINT4={0x14, 0x4, {0x2, 0x4e22, @multicast1}}]}, {0x674, 0x0, 0x0, 0x1, [@WGPEER_A_PERSISTENT_KEEPALIVE_INTERVAL={0x6, 0x5, 0x40}, @WGPEER_A_PERSISTENT_KEEPALIVE_INTERVAL={0x6, 0x5, 0x8}, @WGPEER_A_ENDPOINT4={0x14, 0x4, {0x2, 0x4e22, @broadcast}}, @WGPEER_A_ALLOWEDIPS={0x638, 0x9, 0x0, 0x1, [{0x118, 0x0, 0x0, 0x1, [@ipv4={{0x6}, {0x8, 0x2, @remote}, {0x5, 0x3, 0xe}}, @ipv6={{0x6}, {0x14, 0x2, @initdev={0xfe, 0x88, [], 0x0, 0x0}}, {0x5, 0x3, 0xa}}, @ipv4={{0x6}, {0x8, 0x2, @local}, {0x5, 0x3, 0x1}}, @ipv4={{0x6}, {0x8, 0x2, @loopback}, {0x5, 0x3, 0x9}}, @ipv6={{0x6}, {0x14, 0x2, @mcast1}, {0x5, 0x3, 0x77}}, @ipv4={{0x6}, {0x8, 0x2, @local}, {0x5, 0x3, 0x6}}, @ipv6={{0x6}, {0x14, 0x2, @remote}, {0x5, 0x3, 0x55}}, @ipv6={{0x6}, {0x14, 0x2, @dev={0xfe, 0x80, [], 0x32}}, {0x5, 0x3, 0x55}}, @ipv6={{0x6}, {0x14, 0x2, @local}, {0x5, 0x3, 0x1}}]}, {0x7c, 0x0, 0x0, 0x1, [@ipv4={{0x6}, {0x8, 0x2, @loopback}, {0x5, 0x3, 0xe}}, @ipv4={{0x6}, {0x8, 0x2, @rand_addr=0x3}, {0x5, 0x3, 0x7}}, @ipv4={{0x6}, {0x8, 0x2, @remote}, {0x5, 0x3, 0x6}}, @ipv4={{0x6}, {0x8, 0x2, @broadcast}, {0x5, 0x3, 0x1a}}, @ipv4={{0x6}, {0x8, 0x2, @initdev={0xac, 0x1e, 0x0, 0x0}}, {0x5, 0x3, 0x1b}}]}, {0x94, 0x0, 0x0, 0x1, [@ipv6={{0x6}, {0x14, 0x2, @local}, {0x5, 0x3, 0x77}}, @ipv4={{0x6}, {0x8, 0x2, @dev={0xac, 0x14, 0x14, 0x1d}}, {0x5, 0x3, 0x9}}, @ipv4={{0x6}, {0x8, 0x2, @remote}, {0x5, 0x3, 0xc}}, @ipv6={{0x6}, {0x14, 0x2, @mcast1}, {0x5, 0x3, 0x11}}, @ipv4={{0x6}, {0x8, 0x2, @rand_addr=0xa0000000}, {0x5, 0x3, 0x3}}]}, {0x4c, 0x0, 0x0, 0x1, [@ipv6={{0x6}, {0x14, 0x2, @local}, {0x5, 0x3, 0x60}}, @ipv6={{0x6}, {0x14, 0x2, @mcast2}, {0x5, 0x3, 0x23}}]}, {0xdc, 0x0, 0x0, 0x1, [@ipv4={{0x6}, {0x8, 0x2, @broadcast}, {0x5, 0x3, 0x1a}}, @ipv4={{0x6}, {0x8, 0x2, @local}, {0x5, 0x3, 0xc}}, @ipv6={{0x6}, {0x14, 0x2, @mcast1}, {0x5, 0x3, 0x7e}}, @ipv6={{0x6}, {0x14, 0x2, @rand_addr="d4c20df960301b9b57dadc769bdced69"}, {0x5, 0x3, 0x4}}, @ipv4={{0x6}, {0x8, 0x2, @initdev={0xac, 0x1e, 0x0, 0x0}}, {0x5, 0x3, 0x7}}, @ipv4={{0x6}, {0x8, 0x2, @local}, {0x5, 0x3, 0x1c}}, @ipv4={{0x6}, {0x8, 0x2, @multicast2}, {0x5}}, @ipv4={{0x6}, {0x8, 0x2, @rand_addr=0x8}, {0x5, 0x3, 0x1b}}]}, {0x28, 0x0, 0x0, 0x1, [@ipv6={{0x6}, {0x14, 0x2, @dev={0xfe, 0x80, [], 0x2b}}, {0x5, 0x3, 0xc}}]}, {0x130, 0x0, 0x0, 0x1, [@ipv6={{0x6}, {0x14, 0x2, @dev={0xfe, 0x80, [], 0xc}}, {0x5, 0x3, 0xb}}, @ipv6={{0x6}, {0x14, 0x2, @local}, {0x5, 0x3, 0x71}}, @ipv6={{0x6}, {0x14, 0x2, @mcast1}, {0x5, 0x3, 0x7}}, @ipv6={{0x6}, {0x14, 0x2, @local}, {0x5, 0x3, 0x2b}}, @ipv4={{0x6}, {0x8, 0x2, @dev={0xac, 0x14, 0x14, 0x31}}, {0x5, 0x3, 0xf}}, @ipv4={{0x6}, {0x8, 0x2, @local}, {0x5, 0x3, 0x19}}, @ipv6={{0x6}, {0x14, 0x2, @dev={0xfe, 0x80, [], 0x42}}, {0x5, 0x3, 0x2f}}, @ipv6={{0x6}, {0x14, 0x2, @mcast1}, {0x5, 0x3, 0x59}}, @ipv6={{0x6}, {0x14, 0x2, @dev={0xfe, 0x80, [], 0x3c}}, {0x5, 0x3, 0x4f}}]}, {0xb8, 0x0, 0x0, 0x1, [@ipv4={{0x6}, {0x8, 0x2, @broadcast}, {0x5, 0x3, 0x11}}, @ipv6={{0x6}, {0x14, 0x2, @local}, {0x5, 0x3, 0xa}}, @ipv6={{0x6}, {0x14, 0x2, @rand_addr="2ca369bc05c289acab19f0b6b650e6fc"}, {0x5, 0x3, 0x35}}, @ipv6={{0x6}, {0x14, 0x2, @remote}, {0x5, 0x3, 0x54}}, @ipv4={{0x6}, {0x8, 0x2, @loopback}, {0x5, 0x3, 0x9}}, @ipv4={{0x6}, {0x8, 0x2, @multicast2}, {0x5, 0x3, 0x1c}}]}, {0x40, 0x0, 0x0, 0x1, [@ipv6={{0x6}, {0x14, 0x2, @ipv4={[], [], @dev={0xac, 0x14, 0x14, 0x42}}}, {0x5, 0x3, 0x42}}, @ipv4={{0x6}, {0x8, 0x2, @multicast1}, {0x5, 0x3, 0x4}}]}, {0x94, 0x0, 0x0, 0x1, [@ipv6={{0x6}, {0x14, 0x2, @initdev={0xfe, 0x88, [], 0x1, 0x0}}, {0x5, 0x3, 0x64}}, @ipv6={{0x6}, {0x14, 0x2, @initdev={0xfe, 0x88, [], 0x1, 0x0}}, {0x5, 0x3, 0x75}}, @ipv6={{0x6}, {0x14, 0x2, @remote}, {0x5, 0x3, 0x3d}}, @ipv6={{0x6}, {0x14, 0x2, @remote}, {0x5, 0x3, 0x1c}}]}]}, @WGPEER_A_ALLOWEDIPS={0x4}, @WGPEER_A_PERSISTENT_KEEPALIVE_INTERVAL={0x6, 0x5, 0x3}, @WGPEER_A_FLAGS={0x8, 0x3, 0x3}]}, {0xc, 0x0, 0x0, 0x1, [@WGPEER_A_PROTOCOL_VERSION={0x8}]}, {0x7c, 0x0, 0x0, 0x1, [@WGPEER_A_ENDPOINT6={0x20, 0x4, {0xa, 0x4e20, 0x3, @empty, 0x20}}, @WGPEER_A_PUBLIC_KEY={0x24, 0x1, @b}, @WGPEER_A_PERSISTENT_KEEPALIVE_INTERVAL={0x6, 0x5, 0x2}, @WGPEER_A_PUBLIC_KEY={0x24, 0x1, @b}, @WGPEER_A_PROTOCOL_VERSION={0x8}]}]}]}, 0x894}}, 0x0)
r2 = syz_genetlink_get_family_id$wireguard(&(0x7f0000000480)='wireguard\x00')
sendmsg$WG_CMD_SET_DEVICE(0xffffffffffffffff, &(0x7f0000001340)={0x0, 0x0, &(0x7f0000001300)={&(0x7f0000000080)={0x4c, r2, 0x1, 0x2, 0x0, {}, [@WGDEVICE_A_IFNAME={0x14, 0x2, 'wireguard0\x00'}, @WGDEVICE_A_PRIVATE_KEY={0x24, 0x3, @b}]}, 0x4c}}, 0x0)
