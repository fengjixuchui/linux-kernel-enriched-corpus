# https://syzkaller.appspot.com/bug?id=86c7f0dd3bfa4cd651bb37a04da2cfcabd860225
# See https://goo.gl/kgGztJ for information about syzkaller reproducers.
#{"threaded":true,"collide":true,"repeat":true,"procs":6,"sandbox":"none","fault_call":-1,"tun":true,"tmpdir":true,"cgroups":true,"netdev":true,"resetnet":true,"segv":true}
r0 = socket$kcm(0x11, 0x3, 0x0)
sendmsg(r0, &(0x7f0000000440)={&(0x7f00000000c0)=@nfc={0x103, 0x14}, 0x80, &(0x7f0000000200)=[{0x0}], 0x1}, 0x0)
r1 = socket$inet6_sctp(0xa, 0x5, 0x84)
getsockopt$inet_sctp6_SCTP_DEFAULT_SNDINFO(r1, 0x84, 0x7d, &(0x7f00000001c0)={0xff0f}, &(0x7f0000000200)=0x10)
ioctl(0xffffffffffffffff, 0x1000008912, &(0x7f0000000040)="0af51f023c123f3188a070")
bind$alg(0xffffffffffffffff, &(0x7f0000000140)={0x26, 'hash\x00', 0x0, 0x0, 'vmac64(aes-generic)\x00'}, 0x58)
setsockopt$ALG_SET_KEY(0xffffffffffffffff, 0x117, 0x1, &(0x7f0000000000)="285474dae6badf3ab85f04000000d2eb", 0x10)
r2 = accept(0xffffffffffffffff, 0x0, 0x0)
sendmsg$tipc(r2, &(0x7f0000000100)={0x0, 0x0, &(0x7f00000000c0)=[{&(0x7f0000000080)="37384bad0f9a265db41f24c0f0a57ac52e05756811ce7ced93b100c09301c963", 0x20}], 0x1}, 0x8090)
sendto$packet(r2, &(0x7f0000000340), 0x0, 0x8000, 0x0, 0x0)
sendmmsg$unix(r2, &(0x7f0000003f00)=[{0x0, 0x0, 0x0}, {0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x40}], 0x2, 0x0)
r3 = socket$inet6_sctp(0xa, 0x5, 0x84)
getsockopt$inet_sctp6_SCTP_DEFAULT_SNDINFO(r3, 0x84, 0x7d, &(0x7f00000001c0)={0xff0f}, &(0x7f0000000200)=0x10)
r4 = socket$inet_udplite(0x2, 0x2, 0x88)
ioctl(r4, 0x1000008912, &(0x7f0000000040)="0af51f023c123f3188a070")
setsockopt$ALG_SET_KEY(0xffffffffffffffff, 0x117, 0x1, 0x0, 0x0)
r5 = accept(0xffffffffffffffff, 0x0, 0x0)
sendmsg$tipc(r5, &(0x7f0000000100)={0x0, 0x0, &(0x7f00000000c0)=[{&(0x7f0000000080)}], 0x1}, 0x8090)
sendto$packet(r5, &(0x7f0000000340)="4dad026954a3b311ff384b8bc46e2b1a13071cc8b9e995f3a770dfe7e9d1015be1df343a3f2cf6b6c6803c5ae5a5c1bd8f2b8b365832c673b71a5cc71d02700d675a686c3dab35a5c61873679f5c7ff848acbc1d275ceeae61fb519d0d7a7d3325eea63ef668c88e3397cf7642e65202b9", 0x71, 0x8000, 0x0, 0x0)
sendmmsg$unix(r5, &(0x7f0000003f00)=[{0x0, 0x0, 0x0}, {0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x40}], 0x2, 0x0)
mmap(&(0x7f0000000000/0xff5000)=nil, 0xff5000, 0x4, 0x5c832, 0xffffffffffffffff, 0x0)
openat$cgroup_ro(0xffffffffffffff9c, &(0x7f00000000c0)='memory.events\x00', 0x26e1, 0x0)
ioctl(0xffffffffffffffff, 0x1000008912, &(0x7f0000000040))
socket$key(0xf, 0x3, 0x2)
r6 = socket$inet6(0xa, 0x3, 0x1)
setsockopt$inet6_IPV6_XFRM_POLICY(r6, 0x29, 0x23, &(0x7f0000000380)={{{@in6, @in6=@local, 0x0, 0x0, 0x0, 0x0, 0xa}, {}, {}, 0x0, 0x0, 0x1}, {{@in=@loopback, 0x0, 0x33}, 0x0, @in6=@local, 0x0, 0x0, 0x0, 0x6}}, 0xe8)
connect$inet6(r6, 0x0, 0x0)
sendmmsg(r6, &(0x7f0000007e00), 0xb2, 0x0)
r7 = socket$kcm(0x11, 0x3, 0x0)
sendmsg(r7, 0x0, 0x0)
r8 = socket$alg(0x26, 0x5, 0x0)
bind$alg(r8, &(0x7f0000000140)={0x26, 'hash\x00', 0x0, 0x0, 'vmac64(aes-generic)\x00'}, 0x58)
setsockopt$ALG_SET_KEY(r8, 0x117, 0x1, &(0x7f0000000000)="285474dae6badf3ab85f04000000d2eb", 0x10)
r9 = accept(r8, 0x0, 0x0)
sendmsg$tipc(r9, &(0x7f0000000100)={0x0, 0x0, &(0x7f00000000c0)=[{&(0x7f0000000080)="37384bad0f9a265db41f24c0f0a57ac52e05756811ce7ced93b100c09301c963", 0x20}], 0x1}, 0x8090)
sendto$packet(r9, &(0x7f0000000340)="4dad026954a3b311ff384b8bc46e2b1a13071cc8b9e995f3a770dfe7e9d1015be1df343a3f2cf6b6c6803c5ae5a5c1bd8f2b8b365832c673b71a5cc71d02700d675a686c3dab35a5c61873679f5c7ff848acbc1d275ceeae61fb519d0d7a7d3325eea63ef668c88e3397cf7642e65202b9", 0x71, 0x8000, 0x0, 0x0)
socket$inet_udplite(0x2, 0x2, 0x88)
r10 = socket$alg(0x26, 0x5, 0x0)
setsockopt$ALG_SET_KEY(r10, 0x117, 0x1, 0x0, 0x0)
sendto$packet(0xffffffffffffffff, 0x0, 0x0, 0x8000, 0x0, 0x0)
r11 = socket$netlink(0x10, 0x3, 0x10)
r12 = syz_genetlink_get_family_id$tipc2(&(0x7f0000000040)='TIPCv2\x00')
sendmsg$TIPC_NL_BEARER_ENABLE(r11, &(0x7f0000000000)={0x0, 0x0, &(0x7f00000000c0)={&(0x7f0000000100)={0x8c, r12, 0x1, 0x0, 0x0, {}, [@TIPC_NLA_BEARER={0x78, 0x1, [@TIPC_NLA_BEARER_UDP_OPTS={0x38, 0x4, {{0x14, 0x1, @in={0x2, 0x4e23, @broadcast}}, {0x20, 0x2, @in6={0xa, 0x4e21, 0xf51, @mcast1, 0x3}}}}, @TIPC_NLA_BEARER_NAME={0x10, 0x1, @udp='udp:syz0\x00'}, @TIPC_NLA_BEARER_UDP_OPTS={0x2c, 0x4, {{0x14, 0x1, @in={0x2, 0x4e20, @loopback}}, {0x14, 0x2, @in={0x2, 0x4e21, @multicast1}}}}]}]}, 0x8c}}, 0x4)
socketpair$unix(0x1, 0x5, 0x0, &(0x7f0000000180)={0xffffffffffffffff, <r13=>0xffffffffffffffff})
setsockopt$SO_ATTACH_FILTER(r13, 0x1, 0x1a, &(0x7f00000000c0)={0x2, &(0x7f0000000140)=[{0x50, 0x0, 0x0, 0x6e17}, {0x6}]}, 0x10)
socket$netlink(0x10, 0x3, 0x10)
syz_genetlink_get_family_id$tipc2(&(0x7f0000000040)='TIPCv2\x00')
syz_genetlink_get_family_id$tipc2(&(0x7f0000000040)='TIPCv2\x00')
sendmsg$TIPC_NL_BEARER_ENABLE(0xffffffffffffffff, &(0x7f0000000000)={0x0, 0x0, &(0x7f00000000c0)={0x0}}, 0x4)
recvmmsg(0xffffffffffffffff, &(0x7f0000002a40)=[{{0x0, 0x0, &(0x7f0000001700)=[{0x0}], 0x1}}], 0x1, 0x0, 0x0)
r14 = socket$inet_tcp(0x2, 0x1, 0x0)
getsockopt$inet_tcp_buf(r14, 0x6, 0x0, &(0x7f0000000080)=""/37, &(0x7f00000000c0)=0x25)
r15 = openat$cgroup_root(0xffffffffffffff9c, &(0x7f0000000000)='./cgroup\x00', 0x200002, 0x0)
r16 = openat$cgroup_int(r15, 0x0, 0x2, 0x0)
writev(r16, &(0x7f0000000700), 0x1000000000000110)
r17 = socket$alg(0x26, 0x5, 0x0)
setsockopt$ALG_SET_KEY(r17, 0x117, 0x1, &(0x7f0000000080)="b7f2288a911993f0265df5cf1cdd8b55", 0x10)
r18 = accept$alg(r17, 0x0, 0x0)
write$binfmt_script(r18, &(0x7f0000000000)=ANY=[@ANYRESHEX], 0xff34)
recvmmsg(r18, &(0x7f0000001180)=[{{0x0, 0x0, &(0x7f0000000640)=[{&(0x7f00000002c0)=""/172, 0xfd40}], 0x1}}], 0x1, 0x0, 0x0)
r19 = socket$inet6(0xa, 0x2, 0x0)
connect$inet6(r19, &(0x7f0000000100)={0xa, 0x0, 0x0, @dev, 0x4}, 0x1c)
connect$inet6(r19, &(0x7f0000000280)={0xa, 0x4e24, 0x0, @ipv4={[], [], @multicast2}}, 0x1c)
r20 = socket$inet_tcp(0x2, 0x1, 0x0)
getsockopt$inet_tcp_buf(r20, 0x6, 0x0, &(0x7f0000000080)=""/37, &(0x7f00000000c0)=0x25)
r21 = openat$cgroup_root(0xffffffffffffff9c, &(0x7f0000000000)='./cgroup\x00', 0x200002, 0x0)
openat$cgroup_int(r21, &(0x7f0000000040)='memory.high\x00', 0x2, 0x0)
r22 = socket$inet6(0xa, 0x1, 0x8010000000000084)
bind$inet6(r22, &(0x7f0000ef8cfd)={0xa, 0x4e23, 0x0, @loopback}, 0x1c)
listen(r22, 0x5)
socket$inet6_udplite(0xa, 0x2, 0x88)
r23 = socket$inet6(0xa, 0x3, 0x87)
socket$nl_xfrm(0x10, 0x3, 0x6)
accept(r23, 0x0, 0x0)
getsockopt$inet_sctp_SCTP_RECVRCVINFO(0xffffffffffffffff, 0x84, 0x20, 0x0, 0x0)
r24 = socket$inet(0x2, 0x4000000000000001, 0x0)
bind$inet(r24, &(0x7f0000000000)={0x2, 0x4e23, @multicast1}, 0x10)
sendto$inet(r24, 0x0, 0x0, 0x200007fd, 0x0, 0x0)
setsockopt$sock_int(0xffffffffffffffff, 0x1, 0x0, 0x0, 0x0)
socket$packet(0x11, 0x0, 0x300)
setsockopt$SO_ATTACH_FILTER(0xffffffffffffffff, 0x1, 0x1a, 0x0, 0x0)
syz_emit_ethernet(0x0, 0x0, 0x0)
getsockopt$inet_sctp6_SCTP_PEER_ADDR_THLDS(0xffffffffffffffff, 0x84, 0x1f, 0x0, 0x0)
getsockopt$inet_sctp_SCTP_DELAYED_SACK(0xffffffffffffffff, 0x84, 0x10, 0x0, 0x0)
sendmsg$IPVS_CMD_SET_INFO(0xffffffffffffffff, 0x0, 0x0)
getsockopt$XDP_STATISTICS(0xffffffffffffffff, 0x11b, 0x7, 0x0, 0x0)
sendto$inet(0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x0)
recvmsg(r24, &(0x7f0000000240)={&(0x7f0000000040)=@nfc, 0x80, &(0x7f0000000180)=[{&(0x7f0000003ac0)=""/4096, 0x1000}], 0x1}, 0x0)
socket$kcm(0x10, 0x0, 0x0)
sendmsg$kcm(0xffffffffffffffff, 0x0, 0x0)
write$binfmt_elf64(r24, &(0x7f0000002300)=ANY=[@ANYRES64], 0x1000001bd)
r25 = socket$inet_smc(0x2b, 0x1, 0x0)
setsockopt$inet_MCAST_JOIN_GROUP(r25, 0x0, 0x2a, &(0x7f0000000200)={0x0, {{0x2, 0x0, @multicast2}}}, 0x88)
r26 = socket$inet6(0xa, 0x1, 0x8010000000000084)
bind$inet6(r26, &(0x7f0000ef8cfd)={0xa, 0x4e23, 0x0, @loopback}, 0x1c)
listen(r26, 0x5)
r27 = socket$inet6_udplite(0xa, 0x2, 0x88)
ioctl(r27, 0x20000000008912, &(0x7f0000000500)="0a5c2d0240316222b49a1998e9440d85717070")
r28 = socket$inet6(0xa, 0x3, 0x87)
socket$nl_xfrm(0x10, 0x3, 0x6)
accept(r28, 0x0, 0x0)
r29 = socket$inet(0x2, 0x4000000000000001, 0x0)
setsockopt$inet_tcp_TCP_MD5SIG(r29, 0x6, 0xe, &(0x7f0000000280)={@in={{0x2, 0x0, @local}}, 0x0, 0x2, 0x2, "a77760f5a7645bc43c241d69912dda0c63c2a66726f8cfafd6c8fe2c98de7ba44947a79015f0fe57917cb62a93987a938fdedfce7bbba4fec2d8a09c41fb233245f2604b9e07b8ab79ec15ef2818a179"}, 0xd8)
bind$inet(r29, &(0x7f0000000000)={0x2, 0x4e23, @multicast1}, 0x10)
sendto$inet(r29, 0x0, 0x0, 0x200007fd, &(0x7f00000008c0)={0x2, 0x4e23, @local}, 0x10)
setsockopt$sock_int(0xffffffffffffffff, 0x1, 0x0, 0x0, 0x0)
accept(0xffffffffffffffff, 0x0, 0x0)
socket$packet(0x11, 0x0, 0x300)
setsockopt$SO_ATTACH_FILTER(0xffffffffffffffff, 0x1, 0x1a, 0x0, 0x0)
syz_emit_ethernet(0x0, 0x0, 0x0)
getsockopt$inet_sctp6_SCTP_PEER_ADDR_THLDS(0xffffffffffffffff, 0x84, 0x1f, 0x0, 0x0)
getsockopt$inet_sctp_SCTP_DELAYED_SACK(0xffffffffffffffff, 0x84, 0x10, 0x0, 0x0)
getsockopt$XDP_STATISTICS(0xffffffffffffffff, 0x11b, 0x7, 0x0, 0x0)
sendto$inet(0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x0)
socket$nl_netfilter(0x10, 0x3, 0xc)
setsockopt$RDS_FREE_MR(0xffffffffffffffff, 0x114, 0x3, 0x0, 0x0)
recvmsg(r29, &(0x7f0000000240)={&(0x7f0000000040)=@nfc, 0x80, &(0x7f0000000180)=[{&(0x7f0000003ac0)=""/4096, 0x1000}], 0x1}, 0x0)
socket$kcm(0x10, 0x0, 0x0)
sendmsg$kcm(0xffffffffffffffff, 0x0, 0x0)
write$binfmt_elf64(r29, &(0x7f0000002300)=ANY=[@ANYRES64], 0x1000001bd)
r30 = socket$inet_smc(0x2b, 0x1, 0x0)
setsockopt$inet_MCAST_JOIN_GROUP(r30, 0x0, 0x2a, &(0x7f0000000200)={0x0, {{0x2, 0x0, @multicast2}}}, 0x88)
socket$inet_udplite(0x2, 0x2, 0x88)
r31 = socket$inet(0x10, 0x4000000002, 0x0)
sendmsg(r31, 0x0, 0x0)
r32 = socket$inet6(0xa, 0x1, 0x8010000000000084)
bind$inet6(r32, 0x0, 0x0)
listen(r32, 0x5)
r33 = socket$inet6_udplite(0xa, 0x2, 0x88)
ioctl(r33, 0x20000000008912, &(0x7f0000000500)="0a5c2d0240316222b49a1998e9440d85717070")
r34 = socket$inet6(0xa, 0x3, 0x87)
socket$nl_xfrm(0x10, 0x3, 0x6)
accept(r34, 0x0, 0x0)
getsockopt$inet_sctp_SCTP_RECVRCVINFO(0xffffffffffffffff, 0x84, 0x20, 0x0, 0x0)
r35 = socket$inet(0x2, 0x4000000000000001, 0x0)
bind$inet(r35, &(0x7f0000000000)={0x2, 0x4e23, @multicast1}, 0x10)
sendto$inet(r35, 0x0, 0x0, 0x200007fd, &(0x7f00000008c0)={0x2, 0x4e23, @local}, 0x10)
accept(0xffffffffffffffff, 0x0, 0x0)
syz_genetlink_get_family_id$ipvs(0x0)
setsockopt$SO_ATTACH_FILTER(0xffffffffffffffff, 0x1, 0x1a, 0x0, 0x0)
syz_emit_ethernet(0x0, 0x0, 0x0)
getsockopt$inet_sctp6_SCTP_PEER_ADDR_THLDS(0xffffffffffffffff, 0x84, 0x1f, 0x0, 0x0)
getsockopt$inet_sctp_SCTP_DELAYED_SACK(0xffffffffffffffff, 0x84, 0x10, 0x0, 0x0)
sendmsg$IPVS_CMD_SET_INFO(0xffffffffffffffff, 0x0, 0x0)
getsockopt$XDP_STATISTICS(0xffffffffffffffff, 0x11b, 0x7, 0x0, 0x0)
sendto$inet(0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x0)
socket$nl_netfilter(0x10, 0x3, 0xc)
setsockopt$RDS_FREE_MR(0xffffffffffffffff, 0x114, 0x3, 0x0, 0x0)
recvmsg(r35, &(0x7f0000000240)={&(0x7f0000000040)=@nfc, 0x80, &(0x7f0000000180)=[{&(0x7f0000003ac0)=""/4096, 0xdc00}], 0x1, &(0x7f0000000200)=""/20, 0x14}, 0x0)
sendmsg$kcm(0xffffffffffffffff, 0x0, 0x0)
write$binfmt_elf64(r35, &(0x7f0000002300)=ANY=[@ANYRES64], 0x1000001bd)
r36 = socket$inet_udplite(0x2, 0x2, 0x88)
ioctl(r36, 0x1000008912, &(0x7f0000000000)="0adc1f023c123f3188a070")
r37 = socket$inet(0x10, 0x4000000002, 0x0)
sendmsg(r37, &(0x7f00000000c0)={0x0, 0x0, 0x0}, 0x0)
r38 = socket$inet6(0xa, 0x2, 0x0)
connect$inet6(r38, &(0x7f0000000100)={0xa, 0x0, 0x0, @dev, 0x4}, 0x1c)
connect$inet6(r38, &(0x7f0000000280)={0xa, 0x4e24, 0x0, @ipv4={[], [], @multicast2}}, 0x1c)
sendmmsg(r38, &(0x7f00000092c0), 0x4ff, 0x0)
