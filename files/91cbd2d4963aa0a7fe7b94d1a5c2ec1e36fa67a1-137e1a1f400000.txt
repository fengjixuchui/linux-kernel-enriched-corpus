# https://syzkaller.appspot.com/bug?id=91cbd2d4963aa0a7fe7b94d1a5c2ec1e36fa67a1
# See https://goo.gl/kgGztJ for information about syzkaller reproducers.
#{"threaded":true,"collide":true,"repeat":true,"procs":6,"sandbox":"none","fault_call":-1,"tun":true,"tmpdir":true,"cgroups":true,"netdev":true,"resetnet":true,"segv":true}
r0 = syz_open_dev$usb(&(0x7f0000000040)='/dev/bus/usb/00#/00#\x00', 0x1ff, 0x0)
mmap(&(0x7f0000000000/0xd000)=nil, 0xd000, 0x0, 0x20011, r0, 0x0)
clone(0x0, 0x0, 0x0, 0x0, 0x0)
rmdir(&(0x7f0000000080)='./file1\x00')
perf_event_open(&(0x7f000001d000)={0x1, 0x70, 0x0, 0x0, 0x0, 0x0, 0x0, 0x9a9, 0x0, 0x0, 0x0, 0x4, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, @perf_bp={&(0x7f0000abe000)}}, 0x0, 0xffffffffffffffff, 0xffffffffffffffff, 0x0)
r1 = syz_open_procfs(0x0, &(0x7f00000001c0)='map_files\x00')
add_key$user(&(0x7f00000000c0)='user\x00', &(0x7f0000000140)={'syz', 0x3}, &(0x7f0000000700)="3f88943f7e1fe885117ff14792014d4c51deb841e5fae8111d0327c97c1d000fec7484202f2d9333c168568fa3d48e28a48c2846b822c5ee045685f106eee9537b4552075bf17cdf293411fd18dd76a39d3da505c986c0995345a8d7806aa248b5b967f9f68e9fe2a09830e9b36e14f0f6afaeb6a88a77a136efb9feff7fc991102be5bb373fc664041b0513474eefa1f4ffca7af3e1c3a8087ca95734a6c27ab9d7d844c498c84ff2762ffd6d71b7e0493dfd382b3586db314b262349f7f863aab14c16ffb852c5252cbd29b004c994a412c6e53cc4ac3e1b6cab771a6d731f452077cd8271ba81accf6aae7219069358926c1b509e6ab51bc42f14b09725ed6f72b90458b7646c116f560b52d1c1701ad6b37f0a6cbaeb9bf20ab40da1d8c650b08bc7ddc53f31dc9681649c6e2b652fb7a2110c97fd76b6d5ee416f480654ece8a8b4ddba517cbcd72a6fd17c622ed874a8bb5608eaf23e340eca7dbaeb414f97a8f7f950f97c3e172c8fcc99c0a076958f7a5a9afd6b4f8acb0d48cf5428eb90440f50efeab9ff59dfa861ed4758446ff18804ab928f4c0aad6854f9b309a419b094a167c67af5e016fe83f1b4abcfb0d1cd3daa11367d6c4fd1522697a65898d0071102781f3f949d00b38430aef96d35ff78ba71abe9bd7c8ff08bc00933fe7d8b47461f7268118f85bc18962a4adb80cbeac4f7d13b6487ce482949e01eaa44339ded8f660e221e4fa97018e9879d1cf99800c07902ed93e3d3aab315d718a21377ee97a648dceebc35c5c83a94052b2234a211d1e52310d88a3de1c4d8e00e0d2e593aeb08356f490ac5d607887452742f954c543a9123e919c338a1b66db326db3f8efc72307ca1cbca073d1f08d88df1e261167f66e0a9adcda8ad15fab5bea8eecebed4a51a6ee1d6f7f8b413d7fd3215deee10844ae6974a40c39d96764d7a808abbc35e08c546cb9d50464a1e7a1a610119c09eb79768263a696537aac75bdd8cb1cfad55024067178e56064f789188a3af0ff8929d7f7d1540dade296c3e3f1f75c7eed0c4dedf2db509fe78706c0bef28ef1169c42c7f934f01221f4564b214e9486b62f53fff09921e1be2706824c8c1b235456847a1d3c29bd4b31bb2eac5e6a6bf1644e89c3e57279dfddfd7232db312f3540929a9e40d5b0cd3ad94ef24bda150d282f190d13a5745fc5eac990f56b0384920e130b2457a4178aa2b93025ec3909d76bbdb3353786aecbe93952b29ee7ce48a42a49057edabd0b55331143eac01ca7c17d933d865b70bc156a5648494c2e789b7e72ae3e05cc8b5b783929ac63bf41c62f97819374651cd566473c9f0d2298580310cece7ef4118ca14de4031ec2e843029c7b0fef4b204625849dc3b9abb9dd1948f021f9b169f687b42a309eea1f48ac7d559afcb662d17d0ce6c80755625bd91e8d1ceba9219d83286e4090510edb5e02a6200d3ef5df075e99156983cb51cd7a6622bee22f473e14408555035f8ec7750cc30d0d32cd62396afa3224f06d0a8a67255a5284525f79695c5a2791122c0d32fe9dcd8bd728cc15f22281e1aab3a70efe49b799a4c3c001d79ce88f390f91939e3963b11abec0c044b577471206ef10b6b1b7d63ad2b3b7306dd381a4f0ade255d19cd05586403fa62bdd955baf99e0bb973c53a1b91916dba030cf14e8defb35732d0f74a04d8cc2ce9250edf9b9b2f86eb6d2c0ce460e5fa6d74f54f876e2bf5bf7d33fb2c2b5da61195dc52d9d6dcaab4b35af230171d8155099d74c88c4416f79848b5466a522854d4383ecb8a73f02619e0aea28c92cb883a9cf15be12e1bec35ad7bda4c4683c09d7913ef4a909aaa9a4b3a7d26b93fac9b7c1c3466fc687a66b37d16915301e8edb47502b82aab593c116bf6995d9d74e62de5fd5daf70cd169550142085a72e66a690b510d55108213c70867509cb841e5d1ab5cd8e0ac70ce1bf14fdb252be36cf9564bcb40d96b2edfc70d2b3c4619c5d0d5fc619a869fa5587dade4e675ae662c334183a3230c761f47c22a44a353fcbe58c33f551b6d271d32ae841a50323ed2101d36af5d0ddfc8a4d629c5dc95fe0e913ef149973a900c2370d4f62def7b699e0df5cd6c575d0640f6bd85f718eadb585b13b94b6750a0057b5abdf69dec1859fac6da1deac4fcc47e0308d1c703732b7e5c2b942f46f45216c7d65f50dbbcefd47c91e5d05ffc1591a7d32b245cda2dba049854daffca483596154fa496c10ac3686977e1ace2fbfba9a41a2dc787b4a5c67f6118754e23a6219d2f499a4bececf2b6a03e7eec7d7f9298bb71c1c86ba1810a8416512b15918cca207393a35c017f87d2dbb7fc3031d530287b62347e530ed85e1c38811932075d513676c06b4d21bbed1af204d1e6fa3f0e06b0823966301160aee39edb5dc44cd6950eb06567b1891ca501eadd348610f2ef6b4e73b3bb60030e289e89752adf4d13a7f4fda1e5b2f16d6562cfeab132c9bf946c178053c75a4cace356809cd9539c649a653916aae59f0919b91c56fafeb5a2d4f755204a072d5f754a4140c19b22a50d3cde66bad276f0053a60766ead9ea5d433d293d889b90002cecb7c18fc88e97a779b74bfd38a8a22dbba1dbb75e97be359df04d7d2fc6d0159912e2ee16db1b4406bd4c8e0ff235f76ecc2ea20d918affa0fceb189fb062c9141d7dea2830300cd14bb2bb438da08fd81357783d84566e9bbc7f73e3e1389654561e3bf03c2c25ff10db46c1f32e7eabf1bde9bc404d6a646443e9d46600356da316d25786fbbd336cb50a37475ec063bfa8c9ebc76aa0d3e586df9eac1033aa869a1f46fd8b18a4f0494db21ddefabb4a160f902f48df15f4c7c5296b5e300a4c126d13fdbc7bd9b2", 0x7ff, 0xfffffffffffffffc)
r2 = add_key$keyring(&(0x7f0000000180)='keyring\x00', &(0x7f00000002c0)={'syz', 0x1}, 0x0, 0x0, 0x0)
request_key(&(0x7f0000000300)='asymmetric\x00', &(0x7f0000000340)={'syz', 0x3}, &(0x7f0000000400)='\x00', r2)
add_key(&(0x7f0000000500)='encrypted\x00', &(0x7f0000001700)={'syz', 0x3}, &(0x7f0000001740), 0x0, 0xfffffffffffffff9)
add_key$user(0x0, &(0x7f0000001840)={'syz', 0x3}, &(0x7f0000001880)="6c46815ae627f9a0141b8da31ea371f9e104649bb7cff3dd4916f7008604dbca4c3aa8aabc9dd94421a0b7de049f86e32036621140b83701bea6ae2d854beb3d468596784a3d54e22b732c483f8fecc2ee88d4b335938e879a500706045462fbc4e4f306c8d201a35b59b15347a5d6a7f7bd4593faca122022760ed0ca7896020497d01e4597abd4f1d7f9bf4a372f152785a70bf5d01d3610a15acd99e616abbd842b84", 0xa4, 0xfffffffffffffffb)
add_key$keyring(&(0x7f0000001940)='keyring\x00', &(0x7f0000001980)={'syz', 0x1}, 0x0, 0x0, 0xfffffffffffffffc)
request_key(&(0x7f00000019c0)='.request_key_auth\x00', 0x0, &(0x7f0000001a40)='\x00', 0x0)
request_key(&(0x7f0000001a80)='ceph\x00', &(0x7f0000001ac0)={'syz', 0x2}, &(0x7f0000001b00)='\x00', 0xfffffffffffffff8)
add_key$user(&(0x7f0000001b40)='user\x00', &(0x7f0000001b80)={'syz', 0x3}, &(0x7f0000001bc0)="90c850b4d8143ef6cc7eb4eb6511f11563a3b8c586e4a6ca8c7bc97aea40b28672a3f946b32377362f360f02b734b4651677ebce539e28c79c0cae2f603b77df6dd7bd76a890e84a", 0x48, 0xfffffffffffffffc)
add_key$keyring(&(0x7f0000001c80)='keyring\x00', &(0x7f0000001cc0)={'syz', 0x0}, 0x0, 0x0, 0xfffffffffffffffe)
add_key(0x0, &(0x7f0000001d40)={'syz', 0x3}, &(0x7f0000001d80)="f9205be988175d4b523de53dc13b5c72dea0472b52b316a68ea2b712fa810d0af68ddc2d87e59cdf31f65d29d20033c5a4a6cf62703cc672cb108278723e75b6d3c09aecec9834b123dd74b1fdb2631f74b7cc5acc1898d9248e878ef511508d15d698bb", 0x64, 0xfffffffffffffffe)
add_key$keyring(&(0x7f0000001e00)='keyring\x00', &(0x7f0000001e40)={'syz', 0x2}, 0x0, 0x0, 0xfffffffffffffff8)
add_key$keyring(0x0, 0x0, 0x0, 0x0, 0xfffffffffffffffa)
add_key$user(&(0x7f0000001f00)='user\x00', 0x0, &(0x7f0000001f80)="98ce02ede350d2a7a22aa2fd95e4f2e6ec743e31008a3c595c08607a8868d2f0de4d7a57c9b26d46ea8b9eaa35d6ecdf0fdbfc764e44e89d0d2f0274d1b0d7f4d3bf773fffe7242d4553defc387037afec1669e5373f2b81654ae48360c7acaf6ba0ec939d1df2914767999ec249cf3856f92f76f763fe84b840c5329080d5a3df4d08f75ee4b26a42a819dd2d", 0x8d, 0x0)
add_key$keyring(&(0x7f0000002040)='keyring\x00', &(0x7f0000002080)={'syz', 0x2}, 0x0, 0x0, 0x0)
keyctl$invalidate(0x15, 0x0)
lchown(&(0x7f0000000680)='./file0\x00', 0x0, 0x0)
fchdir(r1)
getdents64(r1, &(0x7f0000000200)=""/116, 0x184)
clone(0x2102001fff, 0x0, 0xfffffffffffffffe, &(0x7f0000000000), 0xffffffffffffffff)
bpf$BPF_PROG_GET_NEXT_ID(0xb, &(0x7f0000000440), 0x4)
r3 = openat(r1, &(0x7f0000000480)='./file2\x00', 0x202, 0x0)
getsockopt$inet6_tcp_buf(0xffffffffffffffff, 0x6, 0x1a, &(0x7f00000005c0)=""/158, &(0x7f00000006c0)=0x9e)
ioctl$FITRIM(0xffffffffffffffff, 0xc0185879, &(0x7f00000003c0)={0x6, 0x6})
ioctl$TIOCGSID(0xffffffffffffffff, 0x5429, 0x0)
perf_event_open(&(0x7f0000000540)={0x0, 0x70, 0x2, 0x9, 0x0, 0x0, 0x0, 0x80, 0x0, 0x1, 0x0, 0x7, 0x0, 0x0, 0x8f, 0x8, 0x0, 0x8, 0x0, 0x0, 0x0, 0x8, 0x5, 0x3, 0xfffffffffffffffc, 0x7, 0x6, 0x6, 0x0, 0x0, 0x0, 0x6, 0xc7de2f7, 0x40, 0xffffffff80000000, 0x1f, 0x6, 0x1, 0x0, 0x5, 0x2, @perf_config_ext={0x0, 0x71}, 0x201, 0x1f, 0x0, 0x4, 0x8001, 0xf6b, 0x8}, 0x0, 0xa, r3, 0xb)
quotactl(0x2080000201, &(0x7f0000000100)='./file1\x00', 0x0, &(0x7f00000002c0))
ioctl$TUNSETQUEUE(0xffffffffffffffff, 0x400454d9, &(0x7f0000000040)={'ip6gretap0\x00', 0x5fe})
