# https://syzkaller.appspot.com/bug?id=cc43803b86884fa3a3ba67d2a88b8d05251bbf76
# See https://goo.gl/kgGztJ for information about syzkaller reproducers.
#{"threaded":true,"collide":true,"repeat":true,"procs":6,"sandbox":"none","fault_call":-1,"tun":true,"tmpdir":true,"cgroups":true,"netdev":true,"resetnet":true,"segv":true}
r0 = socket(0x200000000000011, 0x4000000000080002, 0x0)
bind$packet(r0, &(0x7f0000000040)={0x11, 0x0, 0x0, 0x1, 0x0, 0x6, @broadcast}, 0x14)
setsockopt$packet_int(r0, 0x107, 0x14, &(0x7f0000000180)=0x20, 0x4)
sendmmsg(r0, &(0x7f0000000d00), 0x400004e, 0x0)
r1 = socket$key(0xf, 0x3, 0x2)
sendmsg$key(r1, &(0x7f0000000000)={0x0, 0x0, &(0x7f0000000080)={&(0x7f00000000c0)={0x2, 0x3, 0x0, 0x0, 0x8, 0x0, 0x0, 0x0, [@sadb_key={0x1, 0x9}, @sadb_address={0x3, 0x6, 0x0, 0x0, 0x0, @in={0x2, 0x0, @multicast1}}, @sadb_sa={0x2}]}, 0x40}}, 0x0)
r2 = socket$nl_xfrm(0x10, 0x3, 0x6)
sendmsg$nl_xfrm(r2, &(0x7f0000001500)={&(0x7f0000000140)={0x10, 0x3}, 0xc, &(0x7f00000014c0)={&(0x7f0000000180)=@newsa={0x104, 0x1a, 0x1, 0x0, 0x0, {{@in=@multicast1, @in=@local}, {@in=@multicast1=0xe0000008, 0x0, 0x3c}, @in, {}, {}, {}, 0x0, 0x0, 0xa, 0x2}, [@coaddr={0x14}]}, 0x104}}, 0x0)
socket$key(0xf, 0x3, 0x2)
socket$inet6(0xa, 0x1000000000002, 0x0)
r3 = socket$nl_xfrm(0x10, 0x3, 0x6)
sendmsg$nl_xfrm(r3, &(0x7f0000001500)={&(0x7f0000000140)={0x10, 0x3}, 0xc, &(0x7f00000014c0)={&(0x7f0000000180)=@newsa={0x104, 0x1a, 0x1, 0x0, 0x0, {{@in=@multicast1, @in=@local}, {@in=@multicast1=0xe0000008, 0x0, 0x3c}, @in, {}, {}, {}, 0x0, 0x0, 0xa, 0x2}, [@coaddr={0x14}]}, 0x104}}, 0x0)
r4 = socket$inet6(0xa, 0x1000000000002, 0x0)
getsockopt$sock_timeval(r4, 0x1, 0x15, &(0x7f0000000040), &(0x7f0000000080)=0x10)
r5 = socket$nl_xfrm(0x10, 0x3, 0x6)
sendmsg$nl_xfrm(r5, &(0x7f0000001500)={&(0x7f0000000140)={0x10, 0x3}, 0xc, &(0x7f00000014c0)={&(0x7f0000000180)=@newsa={0x104, 0x1a, 0x1, 0x0, 0x0, {{@in=@multicast1, @in=@local}, {@in=@multicast1=0xe0000008, 0x0, 0x3c}, @in, {}, {}, {}, 0x0, 0x0, 0xa, 0x2}, [@coaddr={0x14}]}, 0x104}}, 0x0)
setsockopt$ALG_SET_KEY(0xffffffffffffffff, 0x117, 0x1, 0x0, 0x0)
socketpair(0x0, 0x0, 0xf34b, 0x0)
connect$netlink(0xffffffffffffffff, 0x0, 0x0)
write$binfmt_script(0xffffffffffffffff, 0x0, 0x0)
r6 = openat$cgroup_ro(0xffffffffffffff9c, &(0x7f00000001c0)="68756765746c04000000000500000000000087563255752c377a580072af114820", 0x275a, 0x0)
ioctl$FS_IOC_FSSETXATTR(r6, 0x401c5820, &(0x7f0000000340)={0x20})
socket$inet_udp(0x2, 0x2, 0x0)
pwrite64(r6, 0x0, 0x0, 0x0)
ioctl$sock_inet_tcp_SIOCOUTQNSD(0xffffffffffffffff, 0x894b, 0x0)
r7 = openat$cgroup_ro(0xffffffffffffff9c, &(0x7f0000000080)="6367706f75702e6576656e7473003ea55e10a8299d73ee6d72da86f4dbed2f19b52a48a90e618729894c918a4985eb8f6f2c31681f988720c1753c87f13d0361b825fe2f4ac4ad9edbd55eebfe0cee240ff894a14ae0ebe6c841b49bedc14402a1528815b5af7235f0efcee6b1cba8728161d61a1ab8a917c2b5", 0x275a, 0x0)
pipe(&(0x7f0000000200)={<r8=>0xffffffffffffffff})
setsockopt$inet6_tcp_TCP_FASTOPEN_KEY(r8, 0x6, 0x21, &(0x7f0000000580)="e657aeab040000005944d1b728e3e3aa", 0x19a)
write$cgroup_int(r7, &(0x7f0000000380), 0x10076)
sendmsg$nfc_llcp(r6, 0x0, 0x0)
ioctl$EXT4_IOC_ALLOC_DA_BLKS(r7, 0x660c)
ioctl$EXT4_IOC_MOVE_EXT(r7, 0xc028660f, 0x0)
r9 = socket$inet6(0xa, 0x1000000000002, 0x0)
getsockopt$sock_timeval(r9, 0x1, 0x15, &(0x7f0000000040), &(0x7f0000000080)=0x10)
socket$inet_udplite(0x2, 0x2, 0x88)
r10 = socket$nl_xfrm(0x10, 0x3, 0x6)
sendmsg$nl_xfrm(r10, &(0x7f0000001500)={&(0x7f0000000140)={0x10, 0x3}, 0xc, &(0x7f00000014c0)={0x0}}, 0x0)
r11 = socket$inet6(0xa, 0x1000000000002, 0x0)
getsockopt$sock_timeval(r11, 0x1, 0x15, &(0x7f0000000040), &(0x7f0000000080)=0x10)
socket$inet_udplite(0x2, 0x2, 0x88)
getsockopt$inet_sctp_SCTP_GET_ASSOC_STATS(0xffffffffffffff9c, 0x84, 0x70, &(0x7f0000000040)={0x0, @in6={{0xa, 0x4e22, 0x1f, @local, 0xe8}}, [0x3, 0xff, 0xb86a, 0x5, 0x800, 0x2, 0x8, 0x7, 0x1, 0x400, 0x6, 0x5, 0x20, 0x7fffffff, 0x4]}, &(0x7f0000000140)=0x100)
r12 = socket$nl_xfrm(0x10, 0x3, 0x6)
sendmsg$nl_xfrm(r12, &(0x7f0000001500)={&(0x7f0000000140)={0x10, 0x3}, 0xc, &(0x7f00000014c0)={&(0x7f0000000180)=@newsa={0x104, 0x1a, 0x1, 0x0, 0x0, {{@in=@multicast1, @in=@local}, {@in=@multicast1=0xe0000008, 0x0, 0x3c}, @in, {}, {}, {}, 0x0, 0x0, 0xa, 0x2}, [@coaddr={0x14}]}, 0x104}}, 0x0)
r13 = socket$packet(0x11, 0x3, 0x300)
setsockopt$packet_tx_ring(r13, 0x107, 0xd, 0x0, 0x0)
sendmmsg(r13, &(0x7f0000008a80)=[{{&(0x7f0000000180)=@ll={0x11, 0x0, 0x0, 0x1, 0x0, 0x6, @link_local}, 0x80, 0x0}}], 0x1, 0x0)
r14 = socket$inet6_tcp(0xa, 0x1, 0x0)
setsockopt$inet6_mreq(r14, 0x29, 0x20000000001b, &(0x7f0000000400)={@ipv4={[], [], @multicast2}}, 0x14)
ioctl$sock_inet_SIOCGARP(0xffffffffffffffff, 0x8955, &(0x7f00000000c0)={{0x2, 0x0, @multicast1}, {0x0, @remote}, 0x0, {}, 'lo\x00'})
